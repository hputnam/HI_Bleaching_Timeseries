# Subset for timeseries and response variables
pcom <- na.omit(subset(Master, Date >= "2019-09-16" & Date <= "2019-10-30" & Species == "Porites compressa")[,c("ColonyID","Bleach","Date","Species","spe.bl","spe.da", "group", "Yield", "BleachScore", "BM.mgcm2", "R.umolcm2hr", "GP.umolcm2hr", "SymSA.cellcm2","ChlSA.ugcm2", "TAC.umolmg", "ProtSA.mgcm2")])
pcom$identifier <- rownames(pcom)
colnames(pcom)[8:16] <- c("Fv/Fm", "BleachScore", "Biomass", "R", "P", "Sym", "Chla", "TAC", "Prot")
# Scale and center data
pcomscaled <- scale(pcom[8:16], center = T, scale = T)
# Identify Factors
fac.pcom <- pcom[1:7]
# PCA
pca.out.pcom <- prcomp(pcomscaled, center=FALSE, scale=FALSE)
summary(pca.out.pcom)
biplot(pca.out.pcom)
PC1 <- pca.out.pcom$x[,1]
PC2 <- pca.out.pcom$x[,2]
# PERMANOVA
mod.pcom <- adonis2(pcomscaled ~ Bleach * Date, data = pcom, method = "euclidian") # PERMANOVA
mod.pcom
vec.pcom <- envfit(pca.out.pcom, pcom[8:16], perm = 1000) #fit physiological vectors onto ordination
vecdf.pcom <- as.data.frame(vec.pcom$vectors$arrows * sqrt(vec.pcom$vectors$r))
vecdf.pcom$variable <- rownames(vecdf.pcom)
# Test for differences in betadispersion species, bleach and date
bdisp.16group.pcom <- betadisper(vegdist(pcomscaled, method = "euclidian"), fac.pcom$group)
anova(bdisp.16group.pcom)
# Test for differences in betadispersion by species and bleach
bdisp.4group.pcom <- betadisper(vegdist(pcomscaled, method = "euclidian"), fac.pcom$spe.bl)
anova(bdisp.4group.pcom)
# Test for differences in betadispersion by species and date
bdisp.8group.pcom <- betadisper(vegdist(pcomscaled, method = "euclidian"), fac.pcom$spe.da)
anova(bdisp.8group.pcom)
# Gather info for plotting
pca.df.pcom <- data.frame(pca.out.pcom$x[,1], y = pca.out.pcom$x[,2],
Colony = as.factor(fac.pcom$ColonyID),
Bleach = as.factor(fac.pcom$Bleach),
Date = as.factor(fac.pcom$Date),
Species = as.factor(fac.pcom$Species),
spe.bl = as.factor(fac.pcom$spe.bl),
spe.da = as.factor(fac.pcom$spe.da),
group = as.factor(fac.pcom$group))
# Order levels
pca.df.pcom$Bleach <- factor(pca.df.pcom$spe.bl, levels = c("Porites compressa Bleach", "Porites compressa Non-bleach"))
pca.df.pcom$Date <- factor(pca.df.pcom$spe.da, levels = c("Porites compressa 2019-09-16", "Porites compressa 2019-10-02", "Porites compressa 2019-10-16", "Porites compressa 2019-10-30"))
pca.df.pcom$group <- factor(pca.df.pcom$group, levels = c("Porites compressa Bleach 2019-09-16", "Porites compressa Non-bleach 2019-09-16", "Porites compressa Bleach 2019-10-02", "Porites compressa Non-bleach 2019-10-02",
"Porites compressa Bleach 2019-10-16", "Porites compressa Non-bleach 2019-10-16", "Porites compressa Bleach 2019-10-30", "Porites compressa Non-bleach 2019-10-30"))
# Set column names
colnames(pca.df.mcap)[1:2] <- c("PC1", "PC2")
colnames(pca.df.pcom)[1:2] <- c("PC1", "PC2")
# Ordination
## Set colors - p,b,1; p,nb,1; p,b,2...
bleachcolors <- c("gray", "black")
date.symbols <- c(3, 5, 15, 16)
par(mfrow=c(1,2))
PCA.M.plot <- ordiplot(pca.out.mcap, type = "n", display = "sites", ylim=c(-5,5), xlim=c(-5,5), xlab=c("PC1 (31%)"), ylab=c("PC2 (20%)"))
points(PCA.M.plot, "sites", col = bleachcolors[pca.df.mcap$Bleach], cex=0.8, pch=date.symbols[pca.df.mcap$Date])
par.new = T
plot(vec.mcap, col = "black", cex = 0.5)
title(main = "MCAP")
legend(x = "left", legend = c("Bleach", "Non-bleach"), col = bleachcolors[pca.df.mcap$Bleach], pch = c(15, 15))
legend(x = "right", legend = c("2019-09-16", "2019-10-02", "2019-10-16", "2019-10-30"), col = "black", pch = c(3, 5, 15, 16))
par(mfrow=c(1,2))
PCA.M.plot <- ordiplot(pca.out.mcap, type = "n", display = "sites", ylim=c(-5,5), xlim=c(-5,5), xlab=c("PC1 (31%)"), ylab=c("PC2 (20%)"))
points(PCA.M.plot, "sites", col = bleachcolors[pca.df.mcap$Bleach], cex=0.8, pch=date.symbols[pca.df.mcap$Date])
par.new = T
plot(vec.mcap, col = "black", cex = 0.5)
title(main = "MCAP")
par.new = T
legend(x = "left", legend = c("Bleach", "Non-bleach"), col = bleachcolors[pca.df.mcap$Bleach], pch = c(15, 15))
legend(x = "right", legend = c("2019-09-16", "2019-10-02", "2019-10-16", "2019-10-30"), col = "black", pch = c(3, 5, 15, 16))
par(mfrow=c(1,2))
legend(x = "left", legend = c("Bleach", "Non-bleach"), col = bleachcolors[pca.df.mcap$Bleach], pch = c(15, 15))
legend(x = "right", legend = c("2019-09-16", "2019-10-02", "2019-10-16", "2019-10-30"), col = "black", pch = c(3, 5, 15, 16))
par(mfrow=c(1,2))
PCA.M.plot <- ordiplot(pca.out.mcap, type = "n", display = "sites", ylim=c(-5,5), xlim=c(-5,5), xlab=c("PC1 (31%)"), ylab=c("PC2 (20%)"))
points(PCA.M.plot, "sites", col = bleachcolors[pca.df.mcap$Bleach], cex=0.8, pch=date.symbols[pca.df.mcap$Date])
par.new = T
plot(vec.mcap, col = "black", cex = 0.5)
title(main = "MCAP")
PCA.P.plot <- ordiplot(pca.out.pcom, type = "n", display = "sites", ylim=c(-5,5), xlim=c(-5,5), xlab=c("PC1 (28%)"), ylab=c("PC2 (16%)"))
legend(x = "left", legend = c("Bleach", "Non-bleach"), col = bleachcolors[pca.df.mcap$Bleach], pch = c(15, 15))
legend(x = "right", legend = c("2019-09-16", "2019-10-02", "2019-10-16", "2019-10-30"), col = "black", pch = c(3, 5, 15, 16))
par(mfrow=c(1,2))
PCA.M.plot <- ordiplot(pca.out.mcap, type = "n", display = "sites", ylim=c(-5,5), xlim=c(-5,5), xlab=c("PC1 (31%)"), ylab=c("PC2 (20%)"))
legend(x = "left", legend = c("Bleach", "Non-bleach"), col = bleachcolors[pca.df.mcap$Bleach], pch = c(15, 15))
legend(x = "right", legend = c("2019-09-16", "2019-10-02", "2019-10-16", "2019-10-30"), col = "black", pch = c(3, 5, 15, 16))
par(mfrow=c(1,2))
PCA.M.plot <- ordiplot(pca.out.mcap, type = "n", display = "sites", ylim=c(-5,5), xlim=c(-5,5), xlab=c("PC1 (31%)"), ylab=c("PC2 (20%)"))
points(PCA.M.plot, "sites", col = bleachcolors[pca.df.mcap$Bleach], cex=0.8, pch=date.symbols[pca.df.mcap$Date])
par.new = T
plot(vec.mcap, col = "black", cex = 0.5)
title(main = "MCAP")
PCA.P.plot <- ordiplot(pca.out.pcom, type = "n", display = "sites", ylim=c(-5,5), xlim=c(-5,5), xlab=c("PC1 (28%)"), ylab=c("PC2 (16%)"))
points(PCA.P.plot, "sites", col = bleachcolors[pca.df.pcom$Bleach], cex=0.8, pch=date.symbols[pca.df.pcom$Date])
par.new = T
plot(vec.pcom, col = "black", cex = 0.5)
title(main = "PCOM")
png("PCA.png", width = 150, height = 90, units = "mm", res = 500)
par(mfrow=c(1,2))
PCA.M.plot <- ordiplot(pca.out.mcap, type = "n", display = "sites", ylim=c(-5,5), xlim=c(-5,5), xlab=c("PC1 (31%)"), ylab=c("PC2 (20%)"))
points(PCA.M.plot, "sites", col = bleachcolors[pca.df.mcap$Bleach], cex=0.8, pch=date.symbols[pca.df.mcap$Date])
par.new = T
plot(vec.mcap, col = "black", cex = 0.5)
title(main = "MCAP")
PCA.P.plot <- ordiplot(pca.out.pcom, type = "n", display = "sites", ylim=c(-5,5), xlim=c(-5,5), xlab=c("PC1 (28%)"), ylab=c("PC2 (16%)"))
points(PCA.P.plot, "sites", col = bleachcolors[pca.df.pcom$Bleach], cex=0.8, pch=date.symbols[pca.df.pcom$Date])
par.new = T
plot(vec.pcom, col = "black", cex = 0.5)
title(main = "PCOM")
dev.off()
setwd("~/Box/Barott lab/Data/Teegan/KBay Bleaching 2019")
library(lme4)
library(ggplot2)
library(MuMIn)
library(car)
library(lmerTest)
library(emmeans)
library(multcomp)
library(lattice)
library(effects)
library(sjPlot)
library(nlme)
rm(list = ls())
Master <- read.csv("KBayBleaching2019.csv")
Master$ColonyID <- as.factor(Master$ColonyID)
Master$Date <- as.Date(Master$Date, format = "%m/%d/%y")
bleachseries <- subset(Master, Date >= "2019-09-16" & Date <= "2019-10-30")
mcap <- subset(bleachseries, Species == "Montipora capitata")
mcap$Date <- as.factor(mcap$Date)
pcom <- subset(bleachseries, Species == "Porites compressa")
pcom$Date <- as.factor(pcom$Date)
set.seed(3593)
##### FIG 2 #####
### Bleaching Score ###
allscores <- Master[complete.cases(Master$BleachScore),]
ggplot(allscores, aes(x = Date, y = BleachScore, color = Bleach)) +
stat_summary(aes(group = Bleach), fun = mean, geom = "point") +
stat_summary(aes(group = Bleach), fun = mean, geom = "line") +
stat_summary(aes(group = Bleach), fun.data = mean_se, geom = "errorbar", width = 3) +
facet_grid(. ~ Species)
## satterthwaite type 3
# MCAP
mcapallscores <- subset(allscores, Species == "Montipora capitata")
mcapallscores$Date <- as.factor(mcapallscores$Date)
mcap.bleach.all <- lmer(BleachScore ~ Bleach * Date + (1|ColonyID), data = mcapallscores)
summary(mcap.bleach.all)
anova(mcap.bleach.all, type = 3)
plot_model(mcap.bleach.all, type = "diag")
qqPlot(residuals(mcap.bleach.all))
cld(emmeans(mcap.bleach.all, ~ Bleach * Date, adjust = "tukey"), Letters = c(LETTERS))
qqPlot(mcap.bleach.all)
qqnorm(mcap.bleach.all)
plot_model(mcap.bleach.all, type = "diag")
plot_model(mcap.bleach.all)
plot_model(mcap.bleach.all, type = "diag")
qqPlot(residuals(mcap.bleach.all))
cld(emmeans(mcap.bleach.all, ~ Bleach * Date, adjust = "tukey"), Letters = c(LETTERS))
# PCOM
pcomallscores <- subset(allscores, Species == "Porites compressa")
pcomallscores$Date <- as.factor(pcomallscores$Date)
pcom.bleach.all <- lmer(BleachScore ~ Bleach * Date + (1|ColonyID), data = pcomallscores)
summary(pcom.bleach.all)
anova(pcom.bleach.all, type = 3)
plot_model(pcom.bleach.all, type = "diag")
qqPlot(residuals(pcom.bleach.all)) # transform? log and sqrt don't change results - keep
cld(emmeans(pcom.bleach.all, ~ Bleach * Date, adjust = "tukey"), Letters = c(LETTERS))
plot(resid(mcap.bleach.all), BleachScore)
qqnorm(resid(mcap.bleach.all))
qqPlot(residuals(mcap.bleach.all))
plot_model(mcap.bleach.all)
plot_model(resid(mcap.bleach.all))
plot_model(residuals(mcap.bleach.all))
plot_model(mcap.bleach.all, type = "diag")
## weighted chi sq type 3
# MCAP
mcap.bleach.all <- lme(BleachScore ~ Bleach * Date, random = ~1|ColonyID, weights = varIdent(form = ~1|Date * Bleach), data = mcapallscores, na.action = na.exclude)
plot(mcap.bleach.all)
qqnorm(mcap.bleach.all, abline = c(0,1))
plot(mcap.bleach.all)
plot(pcom.bleach.all)
qqPlot(residuals(pcom.bleach.all)) # transform? log and sqrt don't change results - keep
qqPlot(residuals(pcom.bleach.all)) # transform? log and sqrt don't change results - keep
## KBayBleach19 Analysis ##
setwd("~/Box/Barott lab/Data/Teegan/KBay Bleaching 2019")
library(lme4)
library(ggplot2)
library(MuMIn)
library(car)
library(lmerTest)
library(emmeans)
library(multcomp)
library(lattice)
library(effects)
library(sjPlot)
library(nlme)
# Import and structure data
rm(list = ls())
Master <- read.csv("KBayBleaching2019.csv")
Master$ColonyID <- as.factor(Master$ColonyID)
Master$Date <- as.Date(Master$Date, format = "%m/%d/%y")
bleachseries <- subset(Master, Date >= "2019-09-16" & Date <= "2019-10-30")
mcap <- subset(bleachseries, Species == "Montipora capitata")
mcap$Date <- as.factor(mcap$Date)
pcom <- subset(bleachseries, Species == "Porites compressa")
pcom$Date <- as.factor(pcom$Date)
set.seed(3593)
##### FIG 2 #####
### Bleaching Score ###
allscores <- Master[complete.cases(Master$BleachScore),]
ggplot(allscores, aes(x = Date, y = BleachScore, color = Bleach)) +
stat_summary(aes(group = Bleach), fun = mean, geom = "point") +
stat_summary(aes(group = Bleach), fun = mean, geom = "line") +
stat_summary(aes(group = Bleach), fun.data = mean_se, geom = "errorbar", width = 3) +
facet_grid(. ~ Species)
# MCAP
mcapallscores <- subset(allscores, Species == "Montipora capitata")
mcapallscores$Date <- as.factor(mcapallscores$Date)
mcap.bleach.all <- lmer(BleachScore ~ Bleach * Date + (1|ColonyID), data = mcapallscores)
summary(mcap.bleach.all)
anova(mcap.bleach.all, type = 3)
Anova(mcap.bleach.all, type = 3)
qqnorm(resid(mcap.bleach.all))
qqPlot(residuals(mcap.bleach.all))
qqline(resid(mcap.bleach.all))
shapiro.test(resid(mcap.bleach.all))
shapiro.test(residuals(mcap.bleach.all)) #
plot(density(mcap.bleach.all))
plot(density(mcapallscores$BleachScore))
qqPlot(residuals(mcap.bleach.all)) # normality of residuals
anova(mcap.bleach.all, type = 3)
Anova(mcap.bleach.all, type = 3)
setwd("~/Box/Barott lab/Data/Teegan/KBay Bleaching 2019")
library(lme4)
library(ggplot2)
library(MuMIn)
library(car)
library(lmerTest)
library(emmeans)
library(multcomp)
library(lattice)
library(effects)
library(sjPlot)
library(nlme)
rm(list = ls())
Master <- read.csv("KBayBleaching2019.csv")
Master$ColonyID <- as.factor(Master$ColonyID)
Master$Date <- as.Date(Master$Date, format = "%m/%d/%y")
bleachseries <- subset(Master, Date >= "2019-09-16" & Date <= "2019-10-30")
mcap <- subset(bleachseries, Species == "Montipora capitata")
mcap$Date <- as.factor(mcap$Date)
pcom <- subset(bleachseries, Species == "Porites compressa")
pcom$Date <- as.factor(pcom$Date)
set.seed(3593)
##### FIG 2 #####
### Bleaching Score ###
allscores <- Master[complete.cases(Master$BleachScore),]
ggplot(allscores, aes(x = Date, y = BleachScore, color = Bleach)) +
stat_summary(aes(group = Bleach), fun = mean, geom = "point") +
stat_summary(aes(group = Bleach), fun = mean, geom = "line") +
stat_summary(aes(group = Bleach), fun.data = mean_se, geom = "errorbar", width = 3) +
facet_grid(. ~ Species)
# MCAP
mcapallscores <- subset(allscores, Species == "Montipora capitata")
mcapallscores$Date <- as.factor(mcapallscores$Date)
mcap.bleach.all <- lmer(BleachScore ~ Bleach * Date + (1|ColonyID), data = mcapallscores)
summary(mcap.bleach.all)
anova(mcap.bleach.all, type = 3) # satterthwaite type iii
Anova(mcap.bleach.all, type = 3) # wald chisq type iii
qqPlot(residuals(mcap.bleach.all)) # normality of residuals
cld(emmeans(mcap.bleach.all, ~ Bleach * Date, adjust = "tukey"), Letters = c(LETTERS))
# PCOM
pcomallscores <- subset(allscores, Species == "Porites compressa")
pcomallscores$Date <- as.factor(pcomallscores$Date)
pcom.bleach.all <- lmer(BleachScore ~ Bleach * Date + (1|ColonyID), data = pcomallscores)
summary(pcom.bleach.all)
anova(pcom.bleach.all, type = 3)
Anova(pcom.bleach.all, type = 3)
Anova(pcom.bleach.all, type = 3)
plot(pcom.bleach.all)
qqPlot(residuals(pcom.bleach.all)) # transform? log and sqrt don't change results - keep
## weighted chi sq type 3
# MCAP
mcap.bleach.2 <- lme(BleachScore ~ Bleach * Date, random = ~1|ColonyID, weights = varIdent(form = ~1|Date * Bleach), data = mcapallscores, na.action = na.exclude)
Anova(mcap.bleach.all, type = 3)
Anova(mcap.bleach.2, type = 3)
## weighted chi sq type 3
# MCAP
mcap.bleach.2 <- lme(BleachScore ~ Bleach * Date, random = ~1|ColonyID, weights = varIdent(form = ~1|Date * Bleach), data = mcapallscores, na.action = na.exclude)
Anova(mcap.bleach.2, type = 3)
## weighted chi sq type 3
# MCAP
mcap.bleach.2 <- lme(BleachScore ~ Bleach * Date, random = ~1|ColonyID, weights = varIdent(form = ~1|Date * Bleach), data = mcapallscores, na.action = na.exclude)
Anova(mcap.bleach.2, type = 3)
# PCOM
pcom.bleach.2 <- lme(BleachScore ~ Bleach * Date, random = ~1|ColonyID, weights = varIdent(form = ~1|Date * Bleach), data = pcomallscores, na.action = na.exclude)
Anova(pcom.bleach.all, type = 3)
Anova(pcom.bleach.2, type = 3)
mcap.bleach.all.2 <- lmer(log10(BleachScore) ~ Bleach * Date + (1|ColonyID), data = mcapallscores)
anova(mcap.bleach.all.2, type = 3)
Anova(mcap.bleach.all.2, type = 3)
qqPlot(residuals(mcap.bleach.all.2))
pcom.bleach.all.2 <- lmer(log10(BleachScore) ~ Bleach * Date + (1|ColonyID), data = pcomallscores)
anova(pcom.bleach.all.2, type = 3)
Anova(pcom.bleach.all.2, type = 3)
qqPlot(residuals(pcom.bleach.all.2))
model.sel(mcap.bleach.all, mcap.bleach.all.2)
model.sel(pcom.bleach.all, pcom.bleach.all.2)
##### FIG 3 #####
### PAM ###
pamseries <- bleachseries[complete.cases(bleachseries$Yield), ]
ggplot(pamseries, aes(x = Date, y = Yield, color = Bleach)) +
stat_summary(aes(group = Bleach), fun = mean, geom = "point") +
stat_summary(aes(group = Bleach), fun = mean, geom = "line") +
stat_summary(aes(group = Bleach), fun.data = mean_se, geom = "errorbar", width = 3) +
facet_grid(. ~ Species)
## satterthwaite type 3
# MCAP
pammcap <- subset(pamseries, Species == "Montipora capitata")
pammcap$Date <- as.factor(pammcap$Date)
mcap.pam <- lmer(Yield ~ Bleach * Date + (1|ColonyID), data = pammcap)
summary(mcap.pam)
anova(mcap.pam, type = 3)
Anova(mcap.pam, type = 3)
qqPlot(residuals(mcap.pam))
mcap.pam.2 <- lmer(log10(Yield) ~ Bleach * Date + (1|ColonyID), data = pammcap)
anova(mcap.pam.2, type = 3)
Anova(mcap.pam.2, type = 3)
# PCOM
pampcom <- subset(pamseries, Species == "Porites compressa")
pampcom$Date <- as.factor(pampcom$Date)
pcom.pam <- lmer(Yield ~ Bleach * Date + (1|ColonyID), data = pampcom)
summary(pcom.pam)
anova(pcom.pam, type = 3)
Anova(pcom.pam, type = 3)
pcom.pam.2 <- lmer(log10(Yield) ~ Bleach * Date + (1|ColonyID), data = pampcom)
anova(pcom.pam.2, type = 3)
Anova(pcom.pam.2, type = 3)
qqPlot(residuals(pcom.bleach.all.2))
qqPlot(residuals(pcom.bleach.all.2))
qqPlot(residuals(pcom.pam))
qqPlot(residuals(pcom.bleach.all.2))
qqPlot(residuals(mcap.pam))
## weighted chi sq type 3
# MCAP
mcap.pam.3 <- lme(log10(Yield) ~ Bleach * Date, random = ~1|ColonyID, weights = varIdent(form = ~1|Date * Bleach), data = pammcap, na.action = na.exclude)
Anova(mcap.pam.3, type = 3)
## weighted chi sq type 3
# MCAP
mcap.pam.3 <- lme(Yield ~ Bleach * Date, random = ~1|ColonyID, weights = varIdent(form = ~1|Date * Bleach), data = pammcap, na.action = na.exclude)
Anova(mcap.pam.3, type = 3)
# PCOM
pcom.pam.3 <- lme(Yield ~ Bleach * Date, random = ~1|ColonyID, weights = varIdent(form = ~1|Date * Bleach), data = pampcom, na.action = na.exclude)
Anova(pcom.pam.3, type = 3)
pcom.pam.4 <- lme(log10(Yield) ~ Bleach * Date, random = ~1|ColonyID, weights = varIdent(form = ~1|Date * Bleach), data = pampcom, na.action = na.exclude)
Anova(pcom.pam.4, type = 3)
### GPSA ###
gpseries <- bleachseries[complete.cases(bleachseries$GP.umolcm2hr), ]
ggplot(gpseries, aes(x = Date, y = GP.umolcm2hr, color = Bleach)) +
stat_summary(aes(group = Bleach), fun = mean, geom = "point") +
stat_summary(aes(group = Bleach), fun = mean, geom = "line") +
stat_summary(aes(group = Bleach), fun.data = mean_se, geom = "errorbar", width = 3) +
facet_grid(. ~ Species)
### GPSA ###
gpseries <- bleachseries[complete.cases(bleachseries$GP.umolcm2hr), ]
ggplot(gpseries, aes(x = Date, y = GP.umolcm2hr, color = Bleach)) +
stat_summary(aes(group = Bleach), fun = mean, geom = "point") +
stat_summary(aes(group = Bleach), fun = mean, geom = "line") +
stat_summary(aes(group = Bleach), fun.data = mean_se, geom = "errorbar", width = 3) +
facet_grid(. ~ Species)
# MCAP
gpmcap <- subset(gpseries, Species == "Montipora capitata")
gpmcap$Date <- as.factor(gpmcap$Date)
mcap.gp <- lmer(GP.umolcm2hr ~ Bleach * Date + (1|ColonyID), data = gpmcap)
summary(mcap.gp)
anova(mcap.gp, type = 3)
Anova(mcap.gp, type = 3)
qqPlot(residuals(mcap.gp))
# PCOM
gppcom <- subset(gpseries, Species == "Porites compressa")
gppcom$Date <- as.factor(gppcom$Date)
pcom.gp <- lmer(GP.umolcm2hr ~ Bleach * Date + (1|ColonyID), data = gppcom)
summary(pcom.gp)
anova(pcom.gp, type = 3)
Anova(pcom.gp, type = 3)
mcap.gp.2 <- lmer(log10(GP.umolcm2hr ~ Bleach * Date + (1|ColonyID), data = gpmcap))
mcap.gp.2 <- lmer(log10(GP.umolcm2hr) ~ Bleach * Date + (1|ColonyID), data = gpmcap))
mcap.gp.2 <- lmer(log10(GP.umolcm2hr) ~ Bleach * Date + (1|ColonyID), data = gpmcap)
anova(mcap.gp.2, type = 3)
Anova(mcap.gp.2, type = 3)
qqPlot(residuals(mcap.gp.2))
qqPlot(residuals(mcap.gp))
qqPlot(residuals(mcap.gp.2))
anova(mcap.pam, type = 3)
Anova(mcap.pam, type = 3)
anova(mcap.pam.2, type = 3)
Anova(mcap.pam.2, type = 3)
Anova(mcap.pam, type = 3)
anova(mcap.pam, type = 3)
anova(mcap.gp, type = 3)
Anova(mcap.gp, type = 3)
anova(mcap.gp.2, type = 3)
Anova(mcap.gp.2, type = 3)
qqPlot(residuals(mcap.gp.2))
qqPlot(residuals(mcap.gp))
# PCOM
gppcom <- subset(gpseries, Species == "Porites compressa")
gppcom$Date <- as.factor(gppcom$Date)
pcom.gp <- lmer(GP.umolcm2hr ~ Bleach * Date + (1|ColonyID), data = gppcom)
anova(pcom.gp, type = 3)
Anova(pcom.gp, type = 3)
pcom.gp.2 <- lmer(log10(GP.umolcm2hr) ~ Bleach * Date + (1|ColonyID), data = gppcom)
anova(pcom.gp.2, type = 3)
Anova(pcom.gp.2, type = 3)
qqPlot(residuals(pcom.gp))
qqPlot(residuals(pcom.gp.2))
qqPlot(residuals(mcap.bleach.all)) # normality of residuals
qqPlot(residuals(mcap.bleach.all.2))
qqPlot(residuals(pcom.bleach.all))
qqPlot(residuals(pcom.bleach.all.2))
qqPlot(residuals(mcap.pam))
qqPlot(residuals(pcom.bleach.all.2))
qqPlot(residuals(pcom.pam))
qqPlot(residuals(pcom.bleach.all.2))
qqPlot(residuals(mcap.gp))
qqPlot(residuals(mcap.gp.2))
qqPlot(residuals(pcom.gp))
qqPlot(residuals(pcom.gp.2))
## weighted chi sq type 3
# MCAP
mcap.gp.3 <- lme(GP.umolcm2hr ~ Bleach * Date, random = ~1|ColonyID, weights = varIdent(form = ~1|Date * Bleach), data = gpmcap, na.action = na.exclude)
Anova(mcap.gp.3, type = 3)
mcap.gp.4 <- lme(log10(GP.umolcm2hr) ~ Bleach * Date, random = ~1|ColonyID, weights = varIdent(form = ~1|Date * Bleach), data = gpmcap, na.action = na.exclude)
Anova(mcap.gp.4, type = 3)
# PCOM
pcom.gp.3 <- lme(GP.umolcm2hr ~ Bleach * Date, random = ~1|ColonyID, weights = varIdent(form = ~1|Date * Bleach), data = gppcom, na.action = na.exclude)
Anova(pcom.gp.3, type = 3)
pcom.gp.4 <- lme(log10(GP.umolcm2hr) ~ Bleach * Date, random = ~1|ColonyID, weights = varIdent(form = ~1|Date * Bleach), data = gppcom, na.action = na.exclude)
Anova(pcom.gp.4, type = 3)
### RSA ###
Rseries <- bleachseries[complete.cases(bleachseries$R.umolcm2hr), ]
ggplot(Rseries, aes(x = Date, y = R.umolcm2hr, color = Bleach)) +
stat_summary(aes(group = Bleach), fun = mean, geom = "point") +
stat_summary(aes(group = Bleach), fun = mean, geom = "line") +
stat_summary(aes(group = Bleach), fun.data = mean_se, geom = "errorbar", width = 3) +
facet_grid(. ~ Species)
## satterthwaite type 3
# MCAP
rmcap <- subset(Rseries, Species == "Montipora capitata")
rmcap$Date <- as.factor(rmcap$Date)
mcap.r <- lmer(R.umolcm2hr ~ Bleach * Date + (1|ColonyID), data = rmcap)
anova(mcap.r, type = 3)
Anova(mcap.r, type = 3)
qqPlot(residuals(mcap.r))
mcap.r.2 <- lmer(log10(R.umolcm2hr) ~ Bleach * Date + (1|ColonyID), data = rmcap)
anova(mcap.r.2, type = 3)
mcap.r.2 <- lmer(R.umolcm2hr ~ Bleach * Date + (1|ColonyID), data = rmcap)
mcap.r.2 <- lmer(log10(R.umolcm2hr) ~ Bleach * Date + (1|ColonyID), data = rmcap)
View(rmcap)
View(rmcap)
mcap.r.2 <- lmer(log10(abs(R.umolcm2hr)) ~ Bleach * Date + (1|ColonyID), data = rmcap)
mcap.r <- lmer(abs(R.umolcm2hr) ~ Bleach * Date + (1|ColonyID), data = rmcap)
anova(mcap.r, type = 3)
Anova(mcap.r, type = 3)
anova(mcap.r.2, type = 3)
Anova(mcap.r.2, type = 3)
qqPlot(residuals(mcap.r.2))
# PCOM
rpcom <- subset(Rseries, Species == "Porites compressa")
rpcom$Date <- as.factor(rpcom$Date)
pcom.r <- lmer(R.umolcm2hr ~ Bleach * Date + (1|ColonyID), data = rpcom)
anova(pcom.r, type = 3)
Anova(pcom.r, type = 3)
pcom.r.2 <- lmer(log10(abs(R.umolcm2hr)) ~ Bleach * Date + (1|ColonyID), data = rpcom)
anova(pcom.r.2, type = 3)
Anova(pcom.r.2, type = 3)
qqPlot(residuals(pcom.r))
qqPlot(residuals(pcom.r.2))
## weighted chi sq type 3
# MCAP
mcap.r.3 <- lme(R.umolcm2hr ~ Bleach * Date, random = ~1|ColonyID, weights = varIdent(form = ~1|Date * Bleach), data = rmcap, na.action = na.exclude)
Anova(mcap.r.3, type = 3)
mcap.r.4 <- lme(log10(abs(R.umolcm2hr)) ~ Bleach * Date, random = ~1|ColonyID, weights = varIdent(form = ~1|Date * Bleach), data = rmcap, na.action = na.exclude)
Anova(mcap.r.3, type = 3)
# PCOM
pcom.r.3 <- lme(R.umolcm2hr ~ Bleach * Date, random = ~1|ColonyID, weights = varIdent(form = ~1|Date * Bleach), data = rpcom, na.action = na.exclude)
Anova(pcom.r.3, type = 3)
pcom.r.4 <- lme(log10(abs(R.umolcm2hr)) ~ Bleach * Date, random = ~1|ColonyID, weights = varIdent(form = ~1|Date * Bleach), data = rpcom, na.action = na.exclude)
Anova(pcom.r.3, type = 3)
knitr::opts_chunk$set(echo = TRUE, warning = FALSE, message = FALSE)
# load packages
library(lme4)
library(ggplot2)
library(MuMIn)
library(car)
library(lmerTest)
library(emmeans)
library(multcomp)
library(lattice)
library(effects)
library(sjPlot)
setwd("~/Documents/Professional/GitHub/HI_Bleaching_Timeseries")
rm(list = ls())
Master <- read.csv("data/PhysData.csv")
Master <- read.csv("data/PhysData.csv")
Master <- read.csv("/data/PhysData.csv")
Master <- read.csv("~/data/PhysData.csv")
Master <- read_csv("data/PhysData.csv")
Master <- read.csv("data/PhysData.csv")
setwd("~/Documents/Professional/GitHub/HI_Bleaching_Timeseries")
library(readr)
rm(list = ls())
Master <- read.csv("data/PhysData.csv")
Master <- read_csv("data/PhysData.csv")
setwd("~/Documents/Professional/GitHub/HI_Bleaching_Timeseries")
Master <- read_csv("data/PhysData.csv")
